#===========================================================
#╭━━━╮         ╭━━━╮
#┃╭━━╯         ┃╭━╮┃
#┃╰━━┳╮╭┳╮╭╮╭┳╮╭╋╯╭╯┃
#┃╭━━┫╰╯┃╰╯╰╯┃╰╯┣╮╰╮┃
#┃┃  ╰╮╭┻╮╭╮╭┫┃┃┃╰━╯┃
#╰╯   ╰╯ ╰╯╰╯╰┻┻┻━━━╯
# Modified by: Diego Cesare <diegocesare300491@gmail.com>
# First modification in: dom 28 nov 2021
#===========================================================

# Folder containing the thumbnails generated by the module Thumbnail
SetEnv cache $[HOME]/.fvwm/cache/
# Folder containing scripts
SetEnv scripts $[HOME]/.fvwm/scripts
# Folder containing icons
SetEnv icons $[HOME]/.fvwm/icons/titlebar/classic
# Folder containing menu icons
SetEnv icons_menu $[HOME]/.fvwm/icons/menu

# Containing all variables
Read $[HOME]/.fvwm/varsrc

# Containing all style
Read $[HOME]/.fvwm/themerc

# DesktopConfiguration sets how fvwm handles desktops:
# * global -- the default. This means all screens show the same desktops/pages.

# * per-monitor -- every monitor has its own virtual desktop/pages.
# For this mode it's recommended that FvwmPager is configured to
# use the monitor configuration option, so that only windows on that
# specific monitor are shown.

# * shared -- the virtual desktops are shared across all monitors and each
# monitor shows a single desktop at a time. If one monitor switches to a
# desktop currently being viewed by another, the two monitors swap which
# desktop they are viewing.  This is similar to how Xmonad or Herbsflutwm
# handle desks.  This mode only works with two or more monitors.

# [Left]  [Right] [Up]  [Down]
# DesktopConfiguration global
DesktopConfiguration per-monitor
# Single monitor
# EWMHBaseStruts 10 10 60 10
# Doble monitors
EWMHBAseStruts screen VGA1 10 10 10 10
EWMHBAseStruts screen HDMI1 0 0 0 0

# Function
AddToFunc FocusRaiseAndStuff
+ I Iconify off
+ I Focus
+ I Raise

AddToFunc SwitchWindow
+ I $[DIR] (CurrentPage, !Iconic, !Sticky) FocusRaiseAndStuff
+ I Deschedule 134000
+ I PipeRead `[ "$[DIR]" == "Prev" ] && \
	echo 'SetEnv NDIR Next' || \
	echo 'SetEnv NDIR Prev'`
+ I Schedule 700 134000 SetEnv DIR $[NDIR]

Key Tab A 4  SwitchWindow

DestroyFunc Thumbnail
AddToFunc Thumbnail

+ I ThisWindow (Shaded) WindowShade
+ I PipeRead 'bash $[scripts]/crthumb "$[w.id]" "$[cache]"'

DestroyFunc DeThumbnail
AddToFunc DeThumbnail
+ I PipeRead 'bash $[scripts]/dethumb "$[w.id]" "$[cache]"'
*FvwmEvent: deiconify DeThumbnail

Style * IconBox 1000x1000-10+60, IconGrid 1 1, \
IconFill top right, !IconTitle, IconBackgroundRelief 0

Key z A 4 Thumbnail

# Start Function
#
# The start function is run right after fvwm is done reading
# the config file. This function run after each restart
# so using Test (Init) or Test (Restart) can further control
# actions that are run during the first time run (Init) or
# actions that are run after a restart.
DestroyFunc StartFunction
AddToFunc   StartFunction

+ I Read panel
+ I Module FvwmEvent EventNewDesk
+ I Module FvwmButtons -g 120x30+5-5 WorkspacePanel
+ I Module FvwmButtons -g 350x30+135-5 MiscPanel
+ I Module FvwmButtons -g 610x30+495-5 NotifPanel

DestroyFunc InitFunction
AddToFunc InitFunction

+ I Module FvwmCommandS
+ I Module FvwmMFL

+ I Exec exec sh ~/.fvwm/scripts/autostart &

# Mouse Bindings Functions
DestroyFunc RaiseMoveX
AddToFunc RaiseMoveX
+ I Raise
+ M $0
+ D $1

DestroyFunc RaiseMove
AddToFunc RaiseMove
+ I Raise
+ M $0

DestroyFunc MoveToCurrent
AddToFunc MoveToCurrent
+ I ThisWindow MoveToPage
+ I ThisWindow MoveToDesk

DesktopSize 2x2
DesktopName 0 0
DesktopName 1 1
DesktopName 2 2
DesktopName 3 3

# EdgeScroll will move the view port between the Pages when the mouse
# moves to the edge of the screen. This set the amount of distance to
# scroll at 100% (full page) and the EdgeResistance which is a timer
# for how long the mouse as at the edge before it scrolls.
# Set EdgeScroll 0 0 and/or EdgeResistance -1 to disable.
EdgeScroll 0 0
EdgeResistance 0
EdgeThickness 1
Style * EdgeMoveDelay 350, EdgeMoveResistance 350

# This sets the ClickTime and MoveThreshold used to determine
# Double Clicks, Hold and Move for the mouse.
ClickTime 250
MoveThreshold 3

# Ignore Numlock and other modifiers for bindings
# See http://fvwm.org/documentation/faq/#why-do-numlock-capslock-and-scrolllock-interfere-with-clicktofocus-andor-my-mouse-bindings
IgnoreModifiers L25

DestroyMenu Power
AddToMenu Power
+ "  $[gt.PowerOff  ]%$[icons_menu]/power.svg:35x35%" Exec exec shutdown now
+ "  $[gt.Reboot  ]%$[icons_menu]/reboot.svg:35x35%" Exec exec reboot
+ "  $[gt.Exit  ]%$[icons_menu]/exit.svg:35x35%" Exec exec pkill -u -9 $USER

# Root Menu
#
# The root menu will PopUp with a click in the root
# window or using alt-f1 (or menu).
DestroyMenu MenuFvwmRoot
AddToMenu   MenuFvwmRoot "━━━━━ Fvwm Menu ━━━━━" Title
+ " $[gt. All Apps  ]%$[icons_menu]/menu.svg:35x35%" Popup XDGMenu
+ "" Nop
+ "━━━━━ Most Used ━━━━━" Title
+ "  Terminal %$[icons_menu]/terminal.svg:35x35%" Exec exec $[infostore.terminal]
+ "  File Manager %$[icons_menu]/folder.svg:35x35%" Exec exec $[infostore.filer]
+ "  Browser %$[icons_menu]/chrome.svg:35x35%" Exec exec $[infostore.browser]
+ "  Netflix %$[icons_menu]/netflix.svg:35x35%" Exec exec xdg-open https://netflix.com
+ "  Telegram %$[icons_menu]/telegram.svg:35x35%" Exec exec $[infostore.chat]
+ "  Editor %$[icons_menu]/code.svg:35x35%" Exec exec $[infostore.editor]
+ "" Nop
+ "━━━━━ Power Menu ━━━━━" Title
+ " $[gt. Power  ]%$[icons_menu]/power-menu.svg:35x35%" Popup Power

PipeRead "fvwm-menu-desktop -e"

# Mouse and Key bindings
# Contexts:
#     R = Root Window                 rrrrrrrrrrrrrrrrrrrrrr
#     W = Application Window          rIrrrr<---------^rrrrr
#     F = Frame Corners               rrrrrr[13TTTT642]rrrrr
#     S = Frame Sides                 rIrrrr[wwwwwwwww]rrrrr
#     T = Title Bar                   rrrrrr[wwwwwwwww]rrrrr
#     I = Icon                        rIrrrrv_________>rrrrr
#                                     rrrrrrrrrrrrrrrrrrrrrr
#
# Numbers are buttons: [1 3 5 7 9  TTTTT  0 8 6 4 2]
# Modifiers: (A)ny, (C)ontrol, (S)hift, (M)eta, (N)othing
# Format: Key <X>  <Context> <Modifier> <Action>
#         Mouse <X> <Context> <Modifier> <Action>

# Tilling
DestroyFunc TileLeft
AddToFunc TileLeft
+ I ThisWindow (!Shaded, !Iconic) Maximize 49 100
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move +0 +0

DestroyFunc TileRight
AddToFunc TileRight
+ I ThisWindow (!Shaded, !Iconic) Maximize 49 100
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move -0 +0

DestroyFunc TileTop
AddToFunc TileTop
+ I ThisWindow (!Shaded, !Iconic) Maximize 100 49
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move +0 +0

DestroyFunc TileBottom
AddToFunc TileBottom
+ I ThisWindow (!Shaded, !Iconic) Maximize 100 49
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move +0 -0

DestroyFunc TileTopLeft
AddToFunc TileTopLeft
+ I ThisWindow (!Shaded, !Iconic) Maximize 49 49
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move +0 +0

DestroyFunc TileTopRight
AddToFunc TileTopRight
+ I ThisWindow (!Shaded, !Iconic) Maximize 49 49
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move -0 +0

DestroyFunc TileBottomLeft
AddToFunc TileBottomLeft
+ I ThisWindow (!Shaded, !Iconic) Maximize 49 49
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move +0 -0

DestroyFunc TileBottomRight
AddToFunc TileBottomRight
+ I ThisWindow (!Shaded, !Iconic) Maximize 49 49
+ I ThisWindow (Maximized, !Shaded, !Iconic) Move -0 -0

# Open Fvwm Menu
Mouse 3 R    A Menu MenuFvwmRoot
# Cancel use click 1
Mouse 1 R    A

Mouse 1 A 4 RaiseMoveX Move
Mouse 3 A 4 RaiseMove Resize
Mouse 4 T A WindowShade True
Mouse 5 T A WindowShade False

Mouse 1 I A Iconify off
Mouse 3 I A Menu MenuIconOps

Mouse 4 R 4 Scroll 100 100
Mouse 5 R 4 Scroll -100 -100

Mouse 1 R A Exec exec eww close spotify & eww close power-box & eww close cal & eww close system

# Silent suppresses any errors (such as keyboards with no Menu key).

# Tilling Keys
Key Left A 4S TileLeft
Key Right A 4S TileRight
Key Up A 4S TileTop
Key Down A 4S TileBottom

Key Up A 4 TileTopLeft
Key Right A 4 TileTopRight
Key Left A 4 TileBottomLeft
Key Down A 4 TileBottomRight

DestroyFunc CenterWindow
AddToFunc   CenterWindow
+ I ThisWindow Piperead "echo Move \
      $(( $[vp.width]/2-$[w.width]/2 ))p \
      $(( $[vp.height]/2-$[w.height]/2 ))p"

DestroyFunc ResizeCenter
AddToFunc ResizeCenter
+ "I" Resize $0 $1 $2
+ "I" CenterWindow

Key Up A C4 ResizeCenter br keep w-1
Key Down A C4 ResizeCenter br keep w+1
Key Left A C4 ResizeCenter br w+1 w-1
Key Right A C4 ResizeCenter br w-1 w+1

# Window Menu
Silent Key Tab A M WindowList Root c c NoDeskSort, NoGeometry, SelectOnRelease Meta_L

# Switch between desktops
Silent Key 1 A 4 GotoDesk 0 0
Silent Key 2 A 4 GotoDesk 0 1
Silent Key 3 A 4 GotoDesk 0 2
Silent Key 4 A 4 GotoDesk 0 3

# Moves the focused window to the selected desktop.
Key 1 A 4S MovetoDesk 0 0
Key 2 A 4S MovetoDesk 0 1
Key 3 A 4S MovetoDesk 0 2
Key 4 A 4S MovetoDesk 0 3

# Open Default Applications
Key Return A 4  Exec exec $[infostore.terminal]
Key c A 4 Exec exec $[infostore.browser]
Key n A 4 Exec exec $[infostore.filer]
Key s A 4 Exec exec $[infostore.music]
Key v A 4 Exec exec $[infostore.editor]
Key t A 4 Exec exec $[infostore.chat]

# Open Rofi Menu
Key m A 4 Exec exec $[infostore.menu]

# Volume control
# Up volume
Key XF86AudioRaiseVolume A A Exec pactl set-sink-volume 0 +5%
# Down volume
Key XF86AudioLowerVolume A A Exec pactl set-sink-volume 0 -5%
# Muted
Key XF86AudioMute A A Exec pactl set-sink-mute 0 toggle

# Window Manager Actions
Key r A 4S Restart
Key e A 4S Quit
Key q A 4 Close
Key space WT 4 Maximize

# Buttons Locations: [1 3 5 7 9  TTTTT  0 8 6 4 2]
#   2 - Close
#   4 - Maximize
#   6 - Minimize

ButtonStyle Reset
ButtonStyle All -- Flat
ButtonStyle All -- UseTitleStyle
AddButtonStyle All Vector 2 70x70@4 70x70@4

AddButtonStyle 1 \
  ActiveUp (Pixmap $[icons]/1.svg$[infostore.ButtonSize] -- Flat) \
  ActiveDown (Pixmap $[icons]/01.svg$[infostore.ButtonSize] -- Flat) \
  Inactive (Pixmap $[icons]/01.svg$[infostore.ButtonSize] -- Flat)

AddButtonStyle 3 \
  ActiveUp (Pixmap $[icons]/2.svg$[infostore.ButtonSize] -- Flat) \
  ActiveDown (Pixmap $[icons]/02.svg$[infostore.ButtonSize] -- Flat) \
  Inactive (Pixmap $[icons]/02.svg$[infostore.ButtonSize] -- Flat)

AddButtonStyle 5 \
  ActiveUp (Pixmap $[icons]/3.svg$[infostore.ButtonSize] -- Flat) \
  ActiveDown (Pixmap $[icons]/03.svg$[infostore.ButtonSize] -- Flat) \
  Inactive (Pixmap $[icons]/03.svg$[infostore.ButtonSize] -- Flat) \

Mouse 1 1 A Close
Mouse 1 3 A Maximize
Mouse 1 5 A Thumbnail
